---
title: "HW2"
format: html
editor: visual
author: Dan Schumacher
date: 9/20/23
---

```{r}
library(ggplot2)
library(tidyverse)
library(DescTools)
library(MASS)
```

# Algorithms 1 Homework 2

### Exercise 1: Analysis of Variance

The heartbpchol.csv data set contains continuous cholesterol (Cholesterol) and blood pressure status (BP_Status) (category: High/ Normal/ Optimal) for alive patients.\

For the heartbpchol data set, consider a one-way ANOVA model to identify differences between group cholesterol means. The normality assumption is reasonable, so you can proceed without testing normality.

Perform a one-way ANOVA for Cholesterol with BP_Status as the categorical predictor. Comment on statistical significance of BP_Status, the amount of variation described by the model, and whether or not the equal variance assumption can be trusted.

-   *Set Up*

    ```{r}
    df_hearts <- read.csv('heartbpchol.csv', header = T)
    head(df_hearts)
    df_hearts$BP_Status = as.factor(df_hearts$BP_Status)
    head(df_hearts)
    ```

-   *Is our data balance?*

```{r}
# it isn't balanced but the tests stay the same
table(df_hearts$BP_Status) 
```

-   *Assumptions of ANOVA*

    -   ~~*Variable types:*~~ *1 quantitative, 1 qualitative*

    -   *I~~ndependence:~~ representative random sample*

    -   ~~*Normality*~~*: We are told in the instructions to trust (normal qqplot looked good)*

    -   ~~*Equal Variances*~~*: We will test with a box plot and3 (passed with Levene*

-   [ANOVA Hypothesis]{.underline}

    H0: muH = muN = muO

    Halt: \@ least 1 not equal.

-   with Levene's p-val of 0.8332 we cannot reject Levene's H0: Equal variance amongst groups

-   With an ANOVA p-value of .00137, we can reject H0, and accept Halt: At least one group has a different mean.

```{r}
# The Variance looks pretty equal, Optimal is a little smaller.
boxplot(Cholesterol ~ BP_Status, data = df_hearts)

# what does this step do?
# we use the anova model before verify assumptions to take advantage of the LT test
# this generates anova output
aov.hearts = aov(Cholesterol ~ BP_Status, data = df_hearts)

# tests for equal var (use for 1-way ANOVA or 2-way Balanced*** maybe)
# p-val = 0.8332 can't reject H0: Equal variance amongst groups
LeveneTest(aov.hearts)

# visually test equal var Larger than 2 way just use visual
plot(aov.hearts)

# now we can interpret aov results
# with a p-val .00137 we reject H0 and accept Halt: at least 1 group has ***
summary(aov.hearts)
```

-   Comment on any significantly different cholesterol means as determined by the post-hoc test comparing all pairwise differences. Specifically explain what that tells us about differences in cholesterol levels across blood pressure status groups, like which group has the highest or lowest mean values of Cholesterol.

### Exercise 2: Analysis of Variance

For this problem use the bupa.csv data set. Check UCI Machine Learning Repository for more\
information (http://archive.ics.uci.edu/ml/datasets/Liver+Disorders). The mean corpuscular volume and\
alkaline phosphates are blood tests thought to be sensitive to liver disorder related to excessive alcohol\
consumption. We assume that normality and independence assumptions are valid

```{r}
df_bupa <- read.csv('bupa.csv')
head(df_bupa)

#change drinkgroup to factor var
df_bupa$drinkgroup <- as.factor(df_bupa$drinkgroup)
head(df_bupa)
```

+---------------+-----------------------------------------------------------------------------------+
| Variable Name | Description                                                                       |
+===============+===================================================================================+
| mcv           | mean corpuscular volume                                                           |
+---------------+-----------------------------------------------------------------------------------+
| alkphos       | alkaline phosphatase                                                              |
+---------------+-----------------------------------------------------------------------------------+
| drinkgroup    | categorization of the half-pint equivalents of alcoholic beverages drunk per day: |
|               |                                                                                   |
|               | **group 1 :**\                                                                    |
|               | less than 1 drink.                                                                |
|               |                                                                                   |
|               | **group 2 :**\                                                                    |
|               | at least 1 but fewer than 3 drinks.                                               |
|               |                                                                                   |
|               | **group 3 :**\                                                                    |
|               | at least 3 but fewer than 6 drinks.                                               |
|               |                                                                                   |
|               | **group 4 :**\                                                                    |
|               | at 6 but fewer than 9 drinks.                                                     |
|               |                                                                                   |
|               | **group 5 :**\                                                                    |
|               | 9 or more drinks.                                                                 |
+---------------+-----------------------------------------------------------------------------------+

Perform a one-way ANOVA for mcv as a function of drinkgroup. Comment on significance of the drinkgroup, the amount of variation described by the model, and whether or not the equal variance assumption can be trusted.

-   with Levene's p-val of .87 we cannot reject Levene's H0: Equal variance amongst groups

-   With an ANOVA p-value of 7.43e-08, we can reject H0, and accept Halt: At least one group has a different mean.

```{r}
aov.mcv = aov(mcv ~ drinkgroup , data = df_bupa)
LeveneTest(aov.mcv)
summary(aov.mcv)
```

Perform a one-way ANOVA for alkphos as a function of drinkgroup. Comment on statistical significance of the drinkgroup, the amount of variation described by the model, and whether or not the equal variance assumption can be trusted.

-   with Levene's p-val of .52 we cannot reject Levene's H0: Equal variance amongst groups

-   With an ANOVA p-val of .00495, we can reject H0 and accept Halt: At least one group has a different mean.

```{r}
aov.alkphos = aov(alkphos ~ drinkgroup , data = df_bupa)
LeveneTest(aov.alkphos)
summary(aov.alkphos)
```

Perform post-hoc tests for models in a) and b). Comment on any similarities or differences you observe from their results.

### Exercise 3

The psychology department at a hypothetical university has been accused of underpaying female faculty members. The data represent salary (in thousands of dollars) for all 22 professors in the department. This problem is from Maxwell and Delaney (2004).

```{r}
df_psych <- read.csv('psych.csv')
df_psych$sex <- as.factor(df_psych$sex)
df_psych$rank <- as.factor(df_psych$rank)
head(df_psych)
```

Fit a two-way ANOVA model including sex (F, M) and rank (Assistant, Associate) the interaction term. What do the Type 1 and Type 3 sums of squares tell us about significance of effects? Is the interaction between sex and rank significant? Also comment on the variation explained by the model.

```{r}
aov.psych <- aov(salary ~ sex + rank, data = df_psych)

#Check for Variance with 2-way, just use visual
plot(aov.psych) #looks good!

print(aov.psych)
summary(aov.psych)
```

-   Refit the model without the interaction term. Comment on the significance of effects and variation explained. Report and interpret the Type 1 and Type 3 tests of the main effects. Are the main effects of rank and sex significant?

-   Obtain model diagnostics to validate your Normality assumptions. Choose a final model based on your results from parts (a) and (b). Comment on any significant group differences through the post-hoc test. State the differences in salary across different main effect groups and interaction (if included) between them.

-   Hint: For interpretations of differences for the main effects, state quantitative interpretations of the significantly different groups (e.g. estimated differences between groups and what the difference tells us about salary). For interaction term, identify significant interactions, but no need to interpret it quantitatively.
